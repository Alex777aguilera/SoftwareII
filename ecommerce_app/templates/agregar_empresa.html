{% extends "base_admin.html" %}
{% block title %}
e-commerce | Admin
{% endblock title %}
{% load static %}
{% block content %}
<br>
<div class="container">
    <section class="content">
        <div class="card shadow mb-4">
            <aside>
                <!-- ============================ COMPONENT PROFILE  ================================= -->
                <div class="card mb-4">
                    <div class="card-header py-3">
                        <h5 class="m-0 font-weight-bold text-primary">Registro de Empresa</h5>
                    </div>
                    <div class="card-body">
                        <form role="form" method="post" enctype="multipart/form-data" action="{% url 'ecommerce_app:agregar_empresa' %}">
                            {% csrf_token %}
                            {% if errores.administrador %}
                            <div class="alert alert-danger alert-dismissible " role="alert">
                                <strong>ERROR! </strong>{{errores.administrador}}
                                {% endif %}
                                <div class="form-row">
                                    <div class="form-group col-md-4">
                                        <label>Logo de la Empresa</label>
                                        <br>
                                        <label for="exampleFormControlFile1">
                                            <input type="file" class="form-control-file" id="imagen_logo" name="imagen_logo" value="{{ret_data.imagen_logo}}">
                                        </label>
                                        {% if errores.imagen_logo %}
                                        <div class="alert alert-danger alert-dismissible " role="alert">
                                            <strong>ERROR! </strong>{{errores.imagen_logo}}
                                        </div>
                                        {% endif %}
                                    </div> <!-- form-group end.// -->
                                </div> <!-- form-row.// -->
                                <div class="form-row">
                                    <div class="col-md-4">
                                        <div class="col form-group">
                                            <label>Nombre</label>
                                            <input type="text" class="form-control" id="id_nombre" name="nombre" placeholder="Nombre de la Empresa" value="{{ret_data.nombre}}">
                                            {% if errores.nombre %}
                                            <div class="alert alert-danger alert-dismissible " role="alert">
                                                <strong>ERROR! </strong>{{errores.nombre}}
                                            </div>
                                            {% endif %}
                                        </div> <!-- form-group end.// -->
                                    </div>
                                    <div class="form-group col-md-4">
                                        <label>Contacto</label>
                                        <input type="text" class="form-control" id="id_contacto" name="telefono" placeholder="Contacto de la Empresa" value="{{ret_data.telefono}}">
                                        {% if errores.telefono %}
                                        <div class="alert alert-danger alert-dismissible " role="alert">
                                            <strong>ERROR! </strong>{{errores.telefono}}
                                        </div>
                                        {% endif %}
                                    </div> <!-- form-group end.// -->
                                    <div class="form-group col-md-4">
                                        <label>Correo</label>
                                        <input type="text" class="form-control" id="id_correo" name="correo" placeholder="Correo de la Empresa" value="{{ret_data.correo}}">
                                        {% if errores.correo %}
                                        <div class="alert alert-danger alert-dismissible " role="alert">
                                            <strong>ERROR! </strong>{{errores.correo}}
                                        </div>
                                        {% endif %}
                                    </div> <!-- form-group end.// -->
                                </div>
                                <div class="form-row ">
                                    <div class="form-group col-md-6">
                                        <label>Direccion de la Empresa</label>
                                        <textarea class="form-control" name="direccion" value="{{ret_data.direccion}}" id="id_direccion" rows="3"></textarea>
                                    </div>
                                    <div class="form-group col-md-6">
                                        <label>Descripcion de la Empresa</label>
                                        <textarea class="form-control" name="descripcion" value="{{ret_data.descripcion}}" id="id_descripcion" rows="3"></textarea>
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group col-md-6">
                                        <label>Latitud de la Empresa</label>
                                        <input type="text" class="form-control" id="id_latitude_empresa" name="latitude_empresa" placeholder="latitud de de la Empresa" value="{{ret_data.latitude_empresa}}">
                                        {% if errores.latitude_empresa %}
                                        <div class="alert alert-danger alert-dismissible " role="alert">
                                            <strong>ERROR! </strong>{{errores.latitude_empresa}}
                                        </div>
                                        {% endif %}
                                    </div> <!-- form-group end.// -->
                                    <div class="form-group col-md-6">
                                        <label>Longitud de la Empresa</label>
                                        <input type="text" class="form-control" id="id_longitude_empresa" name="longitude_empresa" placeholder="longitud de de la Empresa" value="{{ret_data.longitude_empresa}}">
                                        {% if errores.longitude_empresa %}
                                        <div class="alert alert-danger alert-dismissible " role="alert">
                                            <strong>ERROR! </strong>{{errores.longitude_empresa}}
                                        </div>
                                        {% endif %}
                                    </div> <!-- form-group end.// -->
                                </div> <!-- form-row.// -->
                                <button onclick="mapa();" type="button" class="btn btn-secondary" data-toggle="modal" data-target="#modal">
                                    Mostrar ubicación
                                </button>
                                <div class="modal fade" id="modal">
                                    <div class="modal-dialog">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h5 class="modal-title m-0 font-weight-bold text-primary">Ubicación De Empresa</h5>
                                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                    <span aria-hidden="true">&times;</span>
                                                </button>
                                            </div>
                                            <div class="modal-body" style="padding:0;">
                                                <div class="card-body">
                                                    <div class="form-horizontal">
                                                        <div class="form-group">
                                                            <div id="map" style="width:100%; height:400px;"></div>
                                                            <div class="clearfix"></div>
                                                        </div>
                                                        <label>Lat</label>
                                                        <input type="text" style="color:black; width:190px;" id="lat" value="" disabled>
                                                        <label>Lng</label>
                                                        <input type="text" style="color:black; width:190px;" id="lng" value="" disabled>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="modal-footer justify-content-between">
                                                <button type="button" class="btn btn-default" data-dismiss="modal" onchange="">Cerrar</button>
                                                <button type="button" class="btn btn-primary" data-dismiss="modal">Guardar</button>
                                            </div>
                                        </div>
                                        <!-- /.modal-content -->
                                    </div>
                                    <!-- /.modal-dialog -->
                                </div>
                            </div>
                            <center>
                                <div class="col-md-3">
                                    <button type="summit" class="btn btn-primary btn-block">Guardar</button>
                                    <br>
                                </div>
                            </center>
                        </form>
                    </div> <!-- card-body.// -->
                </div> <!-- card .// -->
                <!-- ============================ COMPONENT PROFILE END.// ================================= -->
            </aside>
            <div class="card shadow mb-4">
                <div class="card-header py-3">
                    <h5 class="m-0 font-weight-bold text-primary">Datos de Empresa</h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-striped table-bordered" id="tablaE" width="100%" cellspacing="0">
                            <thead>
                                <tr>
                                    <th>Empresa</th>
                                    <th>Telefono</th>
                                    <th>Correo</th>
                                    <th>Fecha registro</th>
                                    <th>Direccion</th>
                                    <th>Latitude</th>
                                    <th>Longitude</th>
                                    <th>Descripcion</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for empresa in empresas %}
                                <tr>
                                    <td>{{empresa.nombre}}</td>
                                    <td>{{empresa.telefono}}</td>
                                    <td>{{empresa.correo}}</td>
                                    <td>{{empresa.fecha_registro}}</td>
                                    <td>
                                        <center><button type="button" class="btn btn-link" data-toggle="modal" data-target="#ver{{direccion.pk}}" onclick="{{empresa.pk}}">Ver</button></center>
                                    </td>
                                    <td>{{empresa.latitude_empresa}}</td>
                                    <td>{{empresa.longitude_empresa}}</td>
                                    <td>
                                        <center><button type="button" class="btn btn-link" data-toggle="modal" data-target="#ve{{descripcion.pk}}" onclick="{{empresa.pk}}">Ver</button></center>
                                    </td>
                                </tr>
                                <div class="modal fade" id="ver{{direccion.pk}}">
                                    <div class="modal-dialog">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h5 class="m-0 font-weight-bold text-primary"><i class="fa fa-eye" aria-hidden="true"></i>&nbsp;&nbsp;Direccion de: {{empresa.nombre}}</h5>
                                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                    <span aria-hidden="true">&times;</span>
                                                </button>
                                            </div>
                                            <div class="modal-body">
                                                {% csrf_token %}
                                                <div class="row">
                                                    <br>
                                                    <div class="col-sm-6">
                                                        <div class="form-group">
                                                            <center>
                                                                <h6>{{empresa.direccion}}</h6>
                                                            </center>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="modal-footer justify-content">
                                                    <button type="button" class="btn btn-outline-info btn-sm" data-dismiss="modal">Cerrar</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- modal de Descripcion-->
                                <div class="modal fade" id="ve{{descripcion.pk}}">
                                    <div class="modal-dialog">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h5 class="m-0 font-weight-bold text-primary"><i class="fa fa-eye" aria-hidden="true"></i>&nbsp;&nbsp;Descripcion de: {{empresa.nombre}}</h5>
                                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                    <span aria-hidden="true">&times;</span>
                                                </button>
                                            </div>
                                            <div class="modal-body">
                                                {% csrf_token %}
                                                <div class="row">
                                                    <br>
                                                    <div class="col-sm-6">
                                                        <div class="form-group">
                                                            <center>
                                                                <h6>{{empresa.descripcion}}</h6>
                                                            </center>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="modal-footer justify-content">
                                                    <button type="button" class="btn btn-outline-info btn-sm" data-dismiss="modal">Cerrar</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>
<script type="text/javascript" src="{% static 'js/mapa.js' %}"></script>
<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAmLNF_7mdep2BVrJqpuBy_CxQO6TGKqVc&callback=initMap"></script>
{% endblock content %}
{% block js %}
<script type="text/javascript">
$(document).ready(function() {
    $('#tablaE').DataTable();
});
</script>
{% endblock js %}